{% extends "adminpanel/base.html" %}
{% block title %}User{% endblock %}
{% block header %}User Management{% endblock %}

{% block content %}
<style>
.form-card {
    max-width: 650px;
    margin: auto;
    background: #fff;
    border-radius: 14px;
    box-shadow: 0 10px 25px rgba(0,0,0,.08);
}

.form-header {
    padding: 1.5rem 2rem;
    border-bottom: 1px solid #eee;
}

.form-body {
    padding: 2rem;
}

.form-group {
    margin-bottom: 1.4rem;
}

.form-group label {
    font-weight: 600;
    margin-bottom: 6px;
    display: block;
}

.form-input,
.form-select {
    width: 100%;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #e5e7eb;
}

.form-actions {
    display: flex;
    gap: 12px;
    justify-content: flex-end;
    margin-top: 2rem;
}
</style>

<div class="form-card">
    <div class="form-header bg-green-900 text-white md:p-2 p-1 rounded">
        <h2>{% if edit_user %}Edit{% else %}Create{% endif %} User</h2>
    </div>

    <form method="POST" class="form-body">
        {% csrf_token %}

        <div class="form-group">
            <label>Username</label>
            <input type="text" name="username" class="form-input"
                   value="{{ edit_user.username|default:'' }}" required>
        </div>

        <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" class="form-input"
                   value="{{ edit_user.email|default:'' }}">
        </div>

        {% comment %} <div class="form-group">
            <label>Password {% if edit_user %}(leave blank to keep same){% endif %}</label>
            <input type="password" name="password" class="form-input">
        </div> {% endcomment %}
<div class="form-group">
    <label>Password {% if edit_user %}(leave blank to keep same){% endif %}</label>

    <div style="position: relative;">
        <input type="password" name="password" id="passwordField" class="form-input pr-12">

        <button type="button"
                onclick="togglePassword()"
                style="
                    position: absolute;
                    right: 12px;
                    top: 50%;
                    transform: translateY(-50%);
                    background: none;
                    border: none;
                    cursor: pointer;
                    font-weight: 600;
                    color: #065f46;
                ">
            <span id="toggleText">Show</span>
        </button>
    </div>
</div>

        <div class="form-group">
            <label>Role</label>
            <select name="role" class="form-select">
                <option value="staff"
                    {% if edit_user and edit_user.is_staff and not edit_user.is_superuser %}selected{% endif %}>
                    Staff
                </option>
                <option value="superuser"
                    {% if edit_user and edit_user.is_superuser %}selected{% endif %}>
                    Super Admin
                </option>
            </select>
        </div>

        <div class="form-actions">
            <button class="bg-green-900 px-5 py-2 text-white rounded">Save</button>
            <a href="{% url 'vivaan_admin:user_list' %}" class="bg-gray-400 p-2 text-white rounded">Cancel</a>
        </div>
    </form>
</div>

<script>
function togglePassword() {
    const passwordField = document.getElementById("passwordField");
    const toggleText = document.getElementById("toggleText");

    if (passwordField.type === "password") {
        passwordField.type = "text";
        toggleText.textContent = "Hide";
    } else {
        passwordField.type = "password";
        toggleText.textContent = "Show";
    }
}
</script>

{% endblock %}
