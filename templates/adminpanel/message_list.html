{% extends "adminpanel/base.html" %}
{% block title %}Messages{% endblock %}
{% block header %}Contact Messages{% endblock %}

{% block content %}
<style>
{% comment %} .badge {
    padding: 4px 10px;
    border-radius: 999px;
    font-size: 12px;
    font-weight: 600;
}
.badge-new { background:#dc2626; color:white; }
.badge-read { background:#16a34a; color:white; }







    .btn-sm {
    padding: 6px 14px;
    border-radius: 8px;
    font-size: 13px;
    text-decoration: none;
    font-weight: 500;
}

.btn-view {
    background: #e0e7ff;
    color: #3730a3;
}

.btn-view:hover {
    background: #c7d2fe;
}

.btn-delete {
    background: #fee2e2;
    color: #991b1b;
}

.btn-delete:hover {
    background: #fecaca;
} {% endcomment %}

</style>

<div class="card">
    <div class="card-header flex-between">
        <h2>Inbox Messages</h2>
            <a href="{% url 'vivaan_admin:message_create' %}" class="bg-green-900 text-white md:p-2 p-1 rounded">
        + Add Message
    </a>
    </div>
<div class="table-responsive">
    <table class="admin-table">
        <thead>
            <tr>
                <th>Sender</th>
                <th>Subject</th>
                <th>Phone</th>
                <th>Status</th>
                <th>Date</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
        {% for msg in messages %}
            <tr {% if not msg.is_read %}style="background:#fef2f2"{% endif %}>
                <td>
                    <strong>{{ msg.name }}</strong><br>
                    <small>{{ msg.email }}</small>
                </td>
                <td>{{ msg.subject|truncatechars:40 }}</td>
                <td>{{ msg.phone }}</td>
                <td>
                    {% if msg.is_read %}
                        <span class="badge badge-read">Read</span>
                    {% else %}
                        <span class="badge badge-new">New</span>
                    {% endif %}
                </td>
                <td>{{ msg.created_at|date:"M d, Y H:i" }}</td>
                <td>
                    <a href="{% url 'vivaan_admin:message_detail' msg.id %}" class="btn-sm btn-view">
                        View
                    </a>
                    <a href="{% url 'vivaan_admin:message_delete' msg.id %}"
                       class="btn-sm btn-delete"
                       onclick="return confirm('Delete this message?');">
                        Delete
                    </a>
                </td>
            </tr>
        {% empty %}
            <tr>
                <td colspan="6" style="text-align:center;color:#6b7280;">
                    No messages found.
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
    <!-- PAGINATION -->
    {% if messages.paginator.num_pages > 1 %}
    <div class="pagination-wrapper">
        <div class="pagination">
            {% if messages.has_previous %}
                <a href="?page={{ messages.previous_page_number }}">‹ Prev</a>
            {% else %}
                <span class="disabled">‹ Prev</span>
            {% endif %}

            {% for page in messages.paginator.page_range %}
                {% if messages.number == page %}
                    <span class="active">{{ page }}</span>
                {% elif page >= messages.number|add:-2 and page <= messages.number|add:2 %}
                    <a href="?page={{ page }}">{{ page }}</a>
                {% endif %}
            {% endfor %}

            {% if messages.has_next %}
                <a href="?page={{ messages.next_page_number }}">Next ›</a>
            {% else %}
                <span class="disabled">Next ›</span>
            {% endif %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
